<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arquitectura EJB - Gestor de Identidades</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
            margin: -20px -20px 40px -20px;
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.3em;
            opacity: 0.9;
        }
        
        /* Navigation */
        .nav {
            background-color: #f8f9fa;
            padding: 20px;
            margin-bottom: 40px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }
        
        .nav h2 {
            margin-bottom: 15px;
            color: #495057;
        }
        
        .nav ul {
            list-style: none;
        }
        
        .nav li {
            margin-bottom: 10px;
        }
        
        .nav a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .nav a:hover {
            color: #764ba2;
            padding-left: 10px;
        }
        
        /* Content */
        h2 {
            color: #2c3e50;
            margin: 40px 0 20px 0;
            font-size: 2.2em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #34495e;
            margin: 30px 0 15px 0;
            font-size: 1.5em;
        }
        
        h4 {
            color: #7f8c8d;
            margin: 20px 0 10px 0;
            font-size: 1.2em;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        /* Code blocks */
        pre {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        code {
            background-color: #e9ecef;
            color: #495057;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
        }
        
        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        
        /* Architecture diagram */
        .architecture-diagram {
            background-color: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        
        .layer {
            background-color: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 20px;
            margin: 20px auto;
            max-width: 600px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .layer h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .arrow {
            font-size: 2em;
            color: #667eea;
            margin: 10px 0;
        }
        
        /* Lists */
        ul, ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        /* Highlight boxes */
        .highlight {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th {
            background-color: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            background-color: #667eea;
            color: white;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 0 5px;
        }
        
        .badge-success {
            background-color: #28a745;
        }
        
        .badge-warning {
            background-color: #ffc107;
            color: #333;
        }
        
        .badge-danger {
            background-color: #dc3545;
        }
        
        /* Print styles */
        @media print {
            body {
                background-color: white;
            }
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            .nav {
                display: none;
            }
            .header {
                margin: 0;
                padding: 40px 20px;
            }
            pre {
                background-color: #f8f9fa;
                color: #333;
                border: 1px solid #dee2e6;
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            .container {
                padding: 10px;
            }
            pre {
                font-size: 12px;
                padding: 10px;
            }
        }

        /* Syntax highlighting */
        .keyword { color: #f92672; font-weight: bold; }
        .annotation { color: #a6e22e; }
        .string { color: #e6db74; }
        .comment { color: #75715e; font-style: italic; }
        .type { color: #66d9ef; }
        .method { color: #fd971f; }
        
        /* Back to top button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .back-to-top:hover {
            transform: translateY(-5px);
            background-color: #764ba2;
        }
        
        .back-to-top.visible {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Arquitectura EJB - Gestor de Identidades</h1>
            <p>Sistema de Gesti√≥n de Trabajadores del Sector Salud</p>
        </div>
        
        <div class="nav">
            <h2>üìã √çndice</h2>
            <ul>
                <li><a href="#introduccion">1. Introducci√≥n</a></li>
                <li><a href="#arquitectura">2. Arquitectura Implementada</a></li>
                <li><a href="#componentes">3. Componentes del Sistema</a></li>
                <li><a href="#ventajas">4. Ventajas de usar EJBs</a></li>
                <li><a href="#cambios">5. Cambios Realizados</a></li>
                <li><a href="#ejemplos">6. Ejemplos de C√≥digo</a></li>
                <li><a href="#flujo">7. Flujo de Datos</a></li>
                <li><a href="#conclusiones">8. Conclusiones</a></li>
            </ul>
        </div>
        
        <section id="introduccion">
            <h2>üéØ Introducci√≥n</h2>
            <p>Este documento describe la transformaci√≥n de una aplicaci√≥n web simple basada en Servlets a una arquitectura empresarial completa utilizando Enterprise JavaBeans (EJB). El sistema gestiona informaci√≥n de trabajadores del sector salud implementando una arquitectura de tres capas bien definidas.</p>
            
            <h3>¬øQu√© son los EJBs?</h3>
            <p>Los Enterprise JavaBeans son componentes del lado del servidor que encapsulan la l√≥gica de negocio de una aplicaci√≥n empresarial. Jakarta EE (anteriormente Java EE) proporciona un contenedor que gestiona autom√°ticamente aspectos como:</p>
            <ul>
                <li>Transacciones</li>
                <li>Seguridad</li>
                <li>Concurrencia</li>
                <li>Ciclo de vida de componentes</li>
                <li>Inyecci√≥n de dependencias</li>
            </ul>
        </section>
        
        <section id="arquitectura">
            <h2>üèóÔ∏è Arquitectura Implementada</h2>
            <h3>Arquitectura de Tres Capas</h3>
            
            <div class="architecture-diagram">
                <div class="layer">
                    <h4>CAPA DE PRESENTACI√ìN</h4>
                    <ul style="list-style: none; margin-left: 0;">
                        <li>‚Ä¢ Servlets (Controladores)</li>
                        <li>‚Ä¢ JSPs (Vistas)</li>
                        <li>‚Ä¢ Manejo de requests HTTP</li>
                    </ul>
                </div>
                <div class="arrow">‚¨á @EJB (Inyecci√≥n)</div>
                <div class="layer">
                    <h4>CAPA DE NEGOCIO</h4>
                    <ul style="list-style: none; margin-left: 0;">
                        <li>‚Ä¢ Stateless Session Bean</li>
                        <li>‚Ä¢ Reglas de negocio</li>
                        <li>‚Ä¢ Validaciones</li>
                        <li>‚Ä¢ Transacciones</li>
                    </ul>
                </div>
                <div class="arrow">‚¨á @EJB (Inyecci√≥n)</div>
                <div class="layer">
                    <h4>CAPA DE ACCESO A DATOS</h4>
                    <ul style="list-style: none; margin-left: 0;">
                        <li>‚Ä¢ Singleton Session Bean</li>
                        <li>‚Ä¢ Operaciones CRUD</li>
                        <li>‚Ä¢ Control de concurrencia</li>
                        <li>‚Ä¢ Persistencia en memoria</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section id="componentes">
            <h2>üîß Componentes del Sistema</h2>
            
            <h3>1. Singleton Session Bean (Capa de Datos)</h3>
            <h4>¬øQu√© es un Singleton Session Bean?</h4>
            <p>Es un EJB que garantiza que <strong>solo existe una instancia</strong> en toda la aplicaci√≥n. Es ideal para:</p>
            <ul>
                <li>Gestionar recursos compartidos</li>
                <li>Implementar cach√©s</li>
                <li>Mantener estado global</li>
                <li>Controlar acceso concurrente a datos</li>
            </ul>
            
            <h4>Implementaci√≥n: <code>TrabajadorSaludDAO.java</code></h4>
            <pre><code><span class="annotation">@Singleton</span>  <span class="comment">// Solo una instancia en toda la aplicaci√≥n</span>
<span class="annotation">@Startup</span>    <span class="comment">// Se inicializa al arrancar el servidor</span>
<span class="annotation">@ConcurrencyManagement</span>(<span class="type">ConcurrencyManagementType</span>.CONTAINER)
<span class="keyword">public class</span> <span class="type">TrabajadorSaludDAO</span> <span class="keyword">implements</span> <span class="type">TrabajadorSaludDAOLocal</span>, <span class="type">TrabajadorSaludDAORemote</span> {
    
    <span class="comment">// Lista thread-safe para almacenar datos</span>
    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">TrabajadorSalud</span>&gt; trabajadores;
    
    <span class="annotation">@PostConstruct</span>
    <span class="keyword">public void</span> <span class="method">init</span>() {
        <span class="comment">// Se ejecuta una sola vez al crear la instancia</span>
        trabajadores = <span class="keyword">new</span> <span class="type">CopyOnWriteArrayList</span>&lt;&gt;();
        LOGGER.info(<span class="string">"DAO inicializado - Una sola instancia para toda la app"</span>);
    }
    
    <span class="annotation">@Lock</span>(<span class="type">LockType</span>.WRITE)  <span class="comment">// Bloqueo exclusivo para escritura</span>
    <span class="keyword">public void</span> <span class="method">agregar</span>(<span class="type">TrabajadorSalud</span> trabajador) {
        <span class="comment">// Solo un thread puede escribir a la vez</span>
        <span class="keyword">if</span> (existeCedula(trabajador.getCedula())) {
            <span class="keyword">throw new</span> <span class="type">IllegalArgumentException</span>(<span class="string">"C√©dula duplicada"</span>);
        }
        trabajadores.add(trabajador);
    }
    
    <span class="annotation">@Lock</span>(<span class="type">LockType</span>.READ)   <span class="comment">// Permite lecturas concurrentes</span>
    <span class="keyword">public</span> <span class="type">List</span>&lt;<span class="type">TrabajadorSalud</span>&gt; <span class="method">obtenerTodos</span>() {
        <span class="comment">// M√∫ltiples threads pueden leer simult√°neamente</span>
        <span class="keyword">return new</span> <span class="type">ArrayList</span>&lt;&gt;(trabajadores);
    }
}</code></pre>
            
            <div class="success">
                <h4>‚úÖ Ventajas del Singleton:</h4>
                <ul>
                    <li>Una sola fuente de verdad para los datos</li>
                    <li>Control autom√°tico de concurrencia</li>
                    <li>Eficiencia en memoria (una sola instancia)</li>
                    <li>Estado compartido coherente</li>
                </ul>
            </div>
            
            <h3>2. Stateless Session Bean (Capa de Negocio)</h3>
            <h4>¬øQu√© es un Stateless Session Bean?</h4>
            <p>Es un EJB que <strong>no mantiene estado</strong> entre llamadas. El contenedor puede:</p>
            <ul>
                <li>Crear m√∫ltiples instancias seg√∫n demanda</li>
                <li>Reutilizar instancias entre clientes</li>
                <li>Optimizar recursos autom√°ticamente</li>
            </ul>
            
            <h4>Implementaci√≥n: <code>TrabajadorSaludService.java</code></h4>
            <pre><code><span class="annotation">@Stateless</span>  <span class="comment">// Sin estado, escalable</span>
<span class="annotation">@TransactionAttribute</span>(<span class="type">TransactionAttributeType</span>.REQUIRED)
<span class="keyword">public class</span> <span class="type">TrabajadorSaludService</span> <span class="keyword">implements</span> <span class="type">TrabajadorSaludServiceLocal</span>, <span class="type">TrabajadorSaludServiceRemote</span> {
    
    <span class="annotation">@EJB</span>  <span class="comment">// Inyecci√≥n autom√°tica del DAO</span>
    <span class="keyword">private</span> <span class="type">TrabajadorSaludDAOLocal</span> trabajadorDAO;
    
    <span class="keyword">public void</span> <span class="method">agregarTrabajador</span>(<span class="type">TrabajadorSalud</span> trabajador) <span class="keyword">throws</span> <span class="type">BusinessException</span> {
        <span class="comment">// VALIDACIONES DE NEGOCIO</span>
        validarTrabajador(trabajador);
        
        <span class="comment">// REGLA DE NEGOCIO: Trabajadores nuevos deben estar activos</span>
        <span class="keyword">if</span> (trabajador.getFechaIngreso().isAfter(<span class="type">LocalDate</span>.now().minusDays(30))) {
            trabajador.setActivo(<span class="keyword">true</span>);
        }
        
        <span class="keyword">try</span> {
            <span class="comment">// Delegar al DAO (transacci√≥n autom√°tica)</span>
            trabajadorDAO.agregar(trabajador);
        } <span class="keyword">catch</span> (<span class="type">IllegalArgumentException</span> e) {
            <span class="comment">// Convertir excepci√≥n t√©cnica en excepci√≥n de negocio</span>
            <span class="keyword">throw new</span> <span class="type">BusinessException</span>(<span class="string">"Error: "</span> + e.getMessage());
        }
    }
}</code></pre>
            
            <h3>3. Interfaces Locales y Remotas</h3>
            <h4>¬øPor qu√© interfaces separadas?</h4>
            <pre><code><span class="annotation">@Local</span>  <span class="comment">// Para clientes en la misma JVM</span>
<span class="keyword">public interface</span> <span class="type">TrabajadorSaludServiceLocal</span> {
    <span class="keyword">void</span> <span class="method">agregarTrabajador</span>(<span class="type">TrabajadorSalud</span> t) <span class="keyword">throws</span> <span class="type">BusinessException</span>;
    <span class="type">List</span>&lt;<span class="type">TrabajadorSalud</span>&gt; <span class="method">obtenerTodos</span>();
}

<span class="annotation">@Remote</span> <span class="comment">// Para clientes remotos (otra JVM, otro servidor)</span>
<span class="keyword">public interface</span> <span class="type">TrabajadorSaludServiceRemote</span> {
    <span class="keyword">void</span> <span class="method">agregarTrabajador</span>(<span class="type">TrabajadorSalud</span> t) <span class="keyword">throws</span> <span class="type">BusinessException</span>;
    <span class="type">List</span>&lt;<span class="type">TrabajadorSalud</span>&gt; <span class="method">obtenerTodos</span>();
}</code></pre>
        </section>
        
        <section id="cambios">
            <h2>üîÑ Cambios Realizados</h2>
            
            <h3>Antes (Sin EJBs)</h3>
            <div class="warning">
                <pre><code><span class="keyword">public class</span> <span class="type">AgregarTrabajadorServlet</span> <span class="keyword">extends</span> <span class="type">HttpServlet</span> {
    <span class="comment">// ‚ùå Lista est√°tica - Problemas de concurrencia</span>
    <span class="keyword">private static</span> <span class="type">List</span>&lt;<span class="type">TrabajadorSalud</span>&gt; trabajadores = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;&gt;();
    
    <span class="keyword">protected void</span> <span class="method">doPost</span>(...) {
        <span class="comment">// ‚ùå Validaciones mezcladas con presentaci√≥n</span>
        <span class="keyword">if</span> (cedula.isEmpty()) {
            errores.add(<span class="string">"C√©dula requerida"</span>);
        }
        
        <span class="comment">// ‚ùå Sin control de concurrencia</span>
        trabajadores.add(nuevoTrabajador);
        
        <span class="comment">// ‚ùå Sin transacciones</span>
        <span class="comment">// ‚ùå Sin separaci√≥n de capas</span>
    }
}</code></pre>
            </div>
            
            <h3>Despu√©s (Con EJBs)</h3>
            <div class="success">
                <pre><code><span class="keyword">public class</span> <span class="type">AgregarTrabajadorServlet</span> <span class="keyword">extends</span> <span class="type">HttpServlet</span> {
    <span class="annotation">@EJB</span>  <span class="comment">// ‚úÖ Inyecci√≥n autom√°tica</span>
    <span class="keyword">private</span> <span class="type">TrabajadorSaludServiceLocal</span> trabajadorService;
    
    <span class="keyword">protected void</span> <span class="method">doPost</span>(...) {
        <span class="keyword">try</span> {
            <span class="comment">// ‚úÖ Delegaci√≥n clara a capa de negocio</span>
            trabajadorService.agregarTrabajador(nuevoTrabajador);
            
            <span class="comment">// ‚úÖ Transacciones autom√°ticas</span>
            <span class="comment">// ‚úÖ Validaciones en capa correcta</span>
            <span class="comment">// ‚úÖ Manejo estructurado de excepciones</span>
        } <span class="keyword">catch</span> (<span class="type">BusinessException</span> e) {
            errores.add(e.getMessage());
        }
    }
}</code></pre>
            </div>
        </section>
        
        <section id="flujo">
            <h2>üîÄ Flujo de Datos</h2>
            <h3>Flujo de Agregar Trabajador</h3>
            <div class="highlight">
                <ol>
                    <li>Usuario llena formulario en <code>agregar-trabajador.jsp</code></li>
                    <li>POST ‚Üí <code>AgregarTrabajadorServlet</code></li>
                    <li>Servlet crea objeto <code>TrabajadorSalud</code></li>
                    <li><code>servlet.trabajadorService.agregarTrabajador(obj)</code></li>
                    <li><code>TrabajadorSaludService.validarTrabajador()</code>
                        <ul>
                            <li>C√©dula 7-10 d√≠gitos ‚úì</li>
                            <li>Matr√≠cula > 1000 ‚úì</li>
                            <li>Fecha v√°lida ‚úì</li>
                        </ul>
                    </li>
                    <li><code>service.trabajadorDAO.agregar(obj)</code></li>
                    <li><code>TrabajadorSaludDAO</code> verifica duplicados</li>
                    <li>DAO agrega a lista (con lock de escritura)</li>
                    <li>Respuesta ‚Üí <code>confirmacion.jsp</code></li>
                </ol>
            </div>
        </section>
        
        <section id="ventajas">
            <h2>üéØ Ventajas de la Arquitectura EJB</h2>
            
            <h3>Comparaci√≥n: Sin EJB vs Con EJB</h3>
            <table>
                <thead>
                    <tr>
                        <th>Aspecto</th>
                        <th>Sin EJB</th>
                        <th>Con EJB</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Concurrencia</strong></td>
                        <td>Manual con synchronized</td>
                        <td>Autom√°tica con @Lock</td>
                    </tr>
                    <tr>
                        <td><strong>Transacciones</strong></td>
                        <td>Try-catch-finally manual</td>
                        <td>@TransactionAttribute</td>
                    </tr>
                    <tr>
                        <td><strong>Instancias</strong></td>
                        <td>Gesti√≥n manual</td>
                        <td>Pool autom√°tico</td>
                    </tr>
                    <tr>
                        <td><strong>Dependencias</strong></td>
                        <td>new Object()</td>
                        <td>@EJB inyecci√≥n</td>
                    </tr>
                    <tr>
                        <td><strong>Escalabilidad</strong></td>
                        <td>Limitada</td>
                        <td>Alta (clustering)</td>
                    </tr>
                    <tr>
                        <td><strong>Testing</strong></td>
                        <td>Dif√≠cil (est√°tico)</td>
                        <td>F√°cil (inyecci√≥n)</td>
                    </tr>
                    <tr>
                        <td><strong>Mantenimiento</strong></td>
                        <td>C√≥digo acoplado</td>
                        <td>Capas separadas</td>
                    </tr>
                </tbody>
            </table>
        </section>
        
        <section id="ejemplos">
            <h2>üìù Ejemplos de C√≥digo</h2>
            
            <h3>Ejemplo 1: Inyecci√≥n de Dependencias</h3>
            <pre><code><span class="annotation">@WebServlet</span>(<span class="string">"/listar-trabajadores"</span>)
<span class="keyword">public class</span> <span class="type">ListarTrabajadorServlet</span> <span class="keyword">extends</span> <span class="type">HttpServlet</span> {
    
    <span class="annotation">@EJB</span>  <span class="comment">// El contenedor inyecta autom√°ticamente la instancia</span>
    <span class="keyword">private</span> <span class="type">TrabajadorSaludServiceLocal</span> service;
    
    <span class="comment">// No necesitas:</span>
    <span class="comment">// - new TrabajadorSaludService()</span>
    <span class="comment">// - Lookup JNDI manual</span>
    <span class="comment">// - Gesti√≥n del ciclo de vida</span>
}</code></pre>
            
            <h3>Ejemplo 2: Control de Transacciones</h3>
            <pre><code><span class="annotation">@Stateless</span>
<span class="keyword">public class</span> <span class="type">TrabajadorSaludService</span> {
    
    <span class="annotation">@TransactionAttribute</span>(<span class="type">TransactionAttributeType</span>.REQUIRED)
    <span class="keyword">public void</span> <span class="method">agregarTrabajador</span>(<span class="type">TrabajadorSalud</span> t) {
        <span class="comment">// Si algo falla, TODA la operaci√≥n se revierte</span>
        validarTrabajador(t);      <span class="comment">// Si falla: rollback</span>
        dao.agregar(t);            <span class="comment">// Si falla: rollback</span>
        enviarNotificacion(t);     <span class="comment">// Si falla: rollback</span>
        <span class="comment">// Si todo OK: commit autom√°tico</span>
    }
}</code></pre>
            
            <h3>Ejemplo 3: Manejo de Concurrencia</h3>
            <pre><code><span class="annotation">@Singleton</span>
<span class="keyword">public class</span> <span class="type">TrabajadorSaludDAO</span> {
    
    <span class="annotation">@Lock</span>(<span class="type">LockType</span>.WRITE)
    <span class="keyword">public void</span> <span class="method">agregar</span>(<span class="type">TrabajadorSalud</span> t) {
        <span class="comment">// Thread 1: agregar("12345") ‚Üí EJECUTA</span>
        <span class="comment">// Thread 2: agregar("67890") ‚Üí ESPERA hasta que Thread 1 termine</span>
    }
    
    <span class="annotation">@Lock</span>(<span class="type">LockType</span>.READ)
    <span class="keyword">public</span> <span class="type">List</span>&lt;<span class="type">TrabajadorSalud</span>&gt; <span class="method">obtenerTodos</span>() {
        <span class="comment">// Thread 1: obtenerTodos() ‚Üí EJECUTA</span>
        <span class="comment">// Thread 2: obtenerTodos() ‚Üí EJECUTA (simult√°neo)</span>
        <span class="comment">// Thread 3: agregar(...)   ‚Üí ESPERA hasta que 1 y 2 terminen</span>
    }
}</code></pre>
        </section>
        
        <section id="conclusiones">
            <h2>üöÄ Conclusiones</h2>
            
            <p>La migraci√≥n a EJBs proporciona:</p>
            
            <div class="success">
                <ol>
                    <li><strong>Robustez</strong>: Manejo autom√°tico de concurrencia y transacciones</li>
                    <li><strong>Escalabilidad</strong>: De aplicaci√≥n simple a sistema empresarial</li>
                    <li><strong>Mantenibilidad</strong>: C√≥digo organizado en capas claras</li>
                    <li><strong>Productividad</strong>: Menos c√≥digo de infraestructura</li>
                    <li><strong>Est√°ndares</strong>: Siguiendo especificaci√≥n Jakarta EE</li>
                </ol>
            </div>
            
            <h3>El sistema ahora est√° preparado para:</h3>
            <ul>
                <li>‚úÖ Manejar m√∫ltiples usuarios concurrentes</li>
                <li>‚úÖ Escalar horizontalmente</li>
                <li>‚úÖ Agregar nuevas funcionalidades f√°cilmente</li>
                <li>‚úÖ Integrar con bases de datos (JPA)</li>
                <li>‚úÖ Implementar servicios REST</li>
                <li>‚úÖ Agregar seguridad empresarial</li>
            </ul>
        </section>
        
        <section id="referencias">
            <h2>üìö Referencias</h2>
            <ul>
                <li><a href="https://jakarta.ee/specifications/" target="_blank">Jakarta EE Documentation</a></li>
                <li><a href="https://jakarta.ee/specifications/enterprise-beans/4.0/" target="_blank">EJB 4.0 Specification</a></li>
                <li><a href="https://docs.wildfly.org/" target="_blank">WildFly Documentation</a></li>
            </ul>
            
            <div class="highlight" style="margin-top: 40px; text-align: center;">
                <p><strong>Autor</strong>: Sistema generado para el curso de Java EE</p>
                <p><strong>Fecha</strong>: Agosto 2024</p>
                <p><strong>Versi√≥n</strong>: 1.0</p>
            </div>
        </section>
    </div>
    
    <!-- Back to top button -->
    <div class="back-to-top" onclick="scrollToTop()" title="Volver arriba">
        ‚Üë
    </div>
    
    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        
        // Back to top button functionality
        const backToTopButton = document.querySelector('.back-to-top');
        
        // Show/hide button based on scroll position
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopButton.classList.add('visible');
            } else {
                backToTopButton.classList.remove('visible');
            }
        });
        
        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Print button
        function printDocument() {
            window.print();
        }
    </script>
</body>
</html>
